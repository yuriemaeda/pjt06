# -*- coding: utf-8 -*-
"""pjt06_è¬›ç¾©ã‚¹ãƒ©ã‚¤ãƒ‰ä½œæˆã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹copilot.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1j_0jIaI2DGIu_GkvW31Ul2KVwGYESOBY
"""

!pip install python-pptx

from google.colab import files

uploaded = files.upload()

# ã‚¹ãƒ©ã‚¤ãƒ‰ãƒ†ã‚­ã‚¹ãƒˆæŠ½å‡º
from pptx import Presentation

def extract_text_from_pptx(file_path):
    prs = Presentation(file_path)
    slide_texts = []

    for i, slide in enumerate(prs.slides):
        text = ""
        for shape in slide.shapes:
            if hasattr(shape, "text"):
                text += shape.text + "\n"
        slide_texts.append((f"Slide {i+1}", text.strip()))

    return slide_texts

# æŠ½å‡ºã—ã¦è¡¨ç¤º
file_name = list(uploaded.keys())[0]

slides = extract_text_from_pptx(file_name)

for slide_num, content in slides:
    print(f"\n=== {slide_num} ===\n{content}")

!pip install google-generativeai

!pip install --upgrade google-generativeai

import google.generativeai as genai

genai.configure(api_key="è‡ªåˆ†ã®API")

model = genai.GenerativeModel("models/gemini-2.5-pro")

def generate_suggestions_gemini(slide_text):
    prompt = f"""
ã‚ãªãŸã¯è¬›ç¾©ã®è£œåŠ©AIã§ã™ã€‚
ä»¥ä¸‹ã¯ã‚¹ãƒ©ã‚¤ãƒ‰ã®å†…å®¹ã§ã™ã€‚ã“ã®å†…å®¹ã«åŸºã¥ã„ã¦ã€
1. å­¦ç”Ÿã‹ã‚‰æƒ³å®šã•ã‚Œã‚‹è³ªå•ï¼ˆ2ã€œ3å€‹ï¼‰
2. è¿½åŠ ã™ã¹ãè£œè¶³èª¬æ˜ï¼ˆ2ã€œ3å€‹ï¼‰
ã‚’ã€ç°¡æ½”ã‹ã¤æ˜ç¢ºã«æ—¥æœ¬èªã§å‡ºåŠ›ã—ã¦ãã ã•ã„ã€‚

# ã‚¹ãƒ©ã‚¤ãƒ‰å†…å®¹:
{slide_text}
"""
    response = model.generate_content(prompt)
    return response.text  # ã“ã“ã§ã‚¨ãƒ©ãƒ¼ã«ãªã‚‹å ´åˆã¯ print(dir(response)) ã§ä¸­èº«ç¢ºèª

print(generate_suggestions_gemini("Omnicampusã®ä½¿ã„æ–¹\nè¨±è«¾ãªãæ’®å½±ã‚„ç¬¬ä¸‰è€…ã¸ã®é–‹ç¤ºã‚’ç¦æ­¢ã—ã¾ã™"))

for slide_num, content in slides:
    print(f"\n=== {slide_num} ===")
    print(f"ğŸ“„ ã‚¹ãƒ©ã‚¤ãƒ‰å†…å®¹:\n{content}\n")
    print("ğŸ’¡ Geminiã®ã‚µã‚¸ã‚§ã‚¹ãƒˆ:")
    try:
        suggestion = generate_suggestions_gemini(content)
        print(suggestion)
    except Exception as e:
        print(f"âš ï¸ ã‚¨ãƒ©ãƒ¼: {e}")

# Geminiã®å‡ºåŠ›ã‚’ã¾ã¨ã‚ã¦ãƒ•ã‚¡ã‚¤ãƒ«ä¿å­˜
with open("gemini_feedback.txt", "w", encoding="utf-8") as f:
    for slide_num, content in slides:
        feedback = generate_suggestions_gemini(content)
        f.write(f"=== {slide_num} ===\nğŸ“„ ã‚¹ãƒ©ã‚¤ãƒ‰å†…å®¹:\n{content}\n\nğŸ’¡ Geminiã®ã‚µã‚¸ã‚§ã‚¹ãƒˆ:\n{feedback}\n\n\n")